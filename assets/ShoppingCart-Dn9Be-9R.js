import{r as p,j as e,i as v,k as b,T as y,L as N}from"./index-db7YC_e6.js";import{B as m}from"./Button-B28T9bZz.js";import{C}from"./Counter-BUYe2ugs.js";import{u as E}from"./useCartActions-BhKY2eb3.js";import{P as L}from"./PageWrapper-DQj5Du9c.js";var j="https://js.stripe.com/v3",P=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,f="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",k=function(){for(var r=document.querySelectorAll('script[src^="'.concat(j,'"]')),n=0;n<r.length;n++){var s=r[n];if(P.test(s.src))return s}return null},h=function(r){var n=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":"",s=document.createElement("script");s.src="".concat(j).concat(n);var t=document.head||document.body;if(!t)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return t.appendChild(s),s},T=function(r,n){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:n})},i=null,u=null,x=null,q=function(r){return function(){r(new Error("Failed to load Stripe.js"))}},G=function(r,n){return function(){window.Stripe?r(window.Stripe):n(new Error("Stripe.js not available"))}},I=function(r){return i!==null?i:(i=new Promise(function(n,s){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&r&&console.warn(f),window.Stripe){n(window.Stripe);return}try{var t=k();if(t&&r)console.warn(f);else if(!t)t=h(r);else if(t&&x!==null&&u!==null){var a;t.removeEventListener("load",x),t.removeEventListener("error",u),(a=t.parentNode)===null||a===void 0||a.removeChild(t),t=h(r)}x=G(n,s),u=q(s),t.addEventListener("load",x),t.addEventListener("error",u)}catch(c){s(c);return}}),i.catch(function(n){return i=null,Promise.reject(n)}))},$=function(r,n,s){if(r===null)return null;var t=r.apply(void 0,n);return T(t,s),t},o,w=!1,g=function(){return o||(o=I(null).catch(function(r){return o=null,Promise.reject(r)}),o)};Promise.resolve().then(function(){return g()}).catch(function(l){w||console.warn(l)});var O=function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];w=!0;var t=Date.now();return g().then(function(a){return $(a,n,t)})};const R=({item:l})=>{const[r,n]=p.useState(l.quantity),{price:s,discount:t,quantity:a,id:c}=l,{removeCartItem:d}=E(),S=t?Math.round(s-s*t):s;return e.jsxs("div",{className:"w-[290px] xxs:w-[350px] xsSm:w-auto xsSm:h-[240px] md:h-[180px] flex flex-col xsSm:flex-row gap-4 border border-divider rounded-xl",children:[e.jsx("div",{className:"cart-list-item__img flexitems-center justify-center h-full xsSm:min-w-[200px] border-r border-divider",children:e.jsx("img",{className:"object-cover h-full w-full aspect-square rounded-l-xl rounded-r-xl xsSm:rounded-r-none",src:l.img,alt:l.name})}),e.jsxs("div",{className:"cart-list-item__info flex flex-col w-full p-6 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between -mt-2 xsSm:mt-0",children:[e.jsx("h1",{className:"text-[20px]",children:l.name}),e.jsx("button",{onClick:()=>d(l),className:"remove p-2 rounded-full duration-300 hover:bg-hoverLightGray",children:e.jsxs("div",{className:"relative h-6 w-6",children:[e.jsx("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 rotate-45 h-[2px] w-full bg-black"}),e.jsx("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 -rotate-45 w-full h-[2px] bg-black"})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between xl:justify-normal gap-6",children:[e.jsx("div",{className:"w-[230px]",children:e.jsx(C,{id:c,value:r,setValue:n})}),e.jsxs("div",{className:`flex ${t?"pr-[55px] xl:pr-0":""} items-center gap-4`,children:[e.jsxs("h2",{className:"font-bold text-[30px] lg:text-[40px] pt-1",children:["$",S*a]}),t&&e.jsxs("h4",{className:"relative text-[20px] text-gray line-through mt-4",children:["$",s*a,e.jsx("div",{className:"absolute font-semibold text-[14px] p-1 px-2 rounded-md bg-green text-white right-[-55px] top-[-10px]",children:`-${t*100}%`})]})]})]})]})]})},_=({list:l})=>{const[r,n]=p.useState(!1),{items:s}=l;return e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:`cart-list duration-300 flex flex-col ${r?"h-auto":`h-[545px] xxs:h-[606px] xsSm:h-[753px] ${s.length>3?"md:h-[573px]":"md:h-min"}`} overflow-hidden gap-4`,children:s.map(t=>e.jsx("li",{className:"cart-list-item flex justify-center items-center xsSm:block",children:e.jsx(R,{item:t})},t.id))}),e.jsx("div",{className:`flex items-center justify-center mt-2 ${s.length>3?"xsSm:flex":s.length>1?"flex xsSm:hidden":"hidden"}`,children:e.jsx(m,{onClick:()=>n(t=>!t),isGreen:!0,text:`${r?"Show less":"Show more"}`})})]})},A=()=>({store:v(r=>r.cart)}),X=()=>{var n;const l=v(s=>s.cart);return{total:(n=l==null?void 0:l.items)==null?void 0:n.reduce((s,t)=>{const a=t.discount?Math.round(t.price-t.price*t.discount):t.price;return s+a*t.quantity},0)}},B=()=>{const{store:l}=A(),{quantity:r}=b(),{total:n}=X(),[s,t]=p.useState(!1);async function a(){t(!0),await(await O("pk_test_51P7L3KDgyJmtJe68W3khXK9oCXDyUzXPP1dOb18twBORDwOgw2uTm9X1lGADHuRvwtt4o6HMHnGXcHfIdHUtTbL600xjCRAbJv")).redirectToCheckout({lineItems:l.items.map(d=>({price:d.api_key,quantity:d.quantity})),mode:"payment",successUrl:"https://lis0vyi13.github.io/garden/#/success",cancelUrl:"https://lis0vyi13.github.io/garden/#/cancel"}),t(!1)}return e.jsxs("section",{className:"cart flex flex-col gap-10",children:[e.jsx(y,{text:"Shopping cart",buttonText:"Back to the store"}),l.value>0?e.jsxs("div",{className:"cart-content flex flex-col xl:flex-row gap-8",children:[e.jsx("div",{className:"xl:w-[60%]",children:e.jsx(_,{list:l})}),e.jsxs("div",{className:"bg-lightGray h-full rounded-xl xl:w-[40%] p-7",children:[e.jsx("h3",{className:"font-bold text-4xl",children:"Order details"}),e.jsxs("div",{className:"pt-4 gap-6 flex flex-col xs:flex-row justify-between",children:[e.jsx("div",{className:"w-full xs:w-1/2",children:e.jsxs("h4",{className:"text-gray text-2xl sm:text-4xl leading-[3rem]",children:[r," items total"]})}),e.jsx("div",{className:"flex self-end items-end",children:e.jsxs("h2",{className:"font-bold text-[37px] lg:text-[46px] break-all",children:["$",n]})})]}),e.jsx("div",{className:"cart-button h-full flex mt-6",children:e.jsx(m,{disabled:s,onClick:()=>{a()},text:"Order",extraClassName:"w-full self-end",isGreen:!0})})]})]}):e.jsxs("div",{className:"-mt-4",children:[e.jsx("p",{children:"Looks like you have no items in your basket currently."}),e.jsx(N,{to:"/all-products?from=&to=&discount=&sortBy=default&category=All+products",children:e.jsx(m,{extraClassName:"mt-5 w-full xs:w-auto",isGreen:!0,text:"Continue Shopping"})})]})]})},M=()=>e.jsx(L,{block:"shopping-cart",children:e.jsx(B,{})});export{M as default};
