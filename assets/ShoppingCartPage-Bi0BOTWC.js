import{i as A,k as w,l as T,n as G,r as u,j as r,m as y,o as S,q as I,T as $,L as O}from"./index-DSu7s7qG.js";import{C as R}from"./Counter-1x7NLMBR.js";import{u as V}from"./useCartActions-DcAh1X-A.js";import{B as p}from"./Button-Dv8o7TUC.js";import{P as _}from"./PageWrapper-xx_QlIsJ.js";import"./useActions-DL_2qWcL.js";function X(t){t.values.forEach(e=>e.stop())}function h(t,e){[...e].reverse().forEach(a=>{const n=t.getVariant(a);n&&w(t,n),t.variantChildren&&t.variantChildren.forEach(o=>{h(o,e)})})}function B(t,e){if(Array.isArray(e))return h(t,e);if(typeof e=="string")return h(t,[e]);w(t,e)}function U(){const t=new Set,e={subscribe(s){return t.add(s),()=>void t.delete(s)},start(s,a){const n=[];return t.forEach(o=>{n.push(A(o,s,{transitionOverride:a}))}),Promise.all(n)},set(s){return t.forEach(a=>{B(a,s)})},stop(){t.forEach(s=>{X(s)})},mount(){return()=>{e.stop()}}};return e}function W(){const t=T(U);return G(t.mount,[]),t}const b=W;var N="https://js.stripe.com/v3",D=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,g="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",H=function(){for(var e=document.querySelectorAll('script[src^="'.concat(N,'"]')),s=0;s<e.length;s++){var a=e[s];if(D.test(a.src))return a}return null},j=function(e){var s=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",a=document.createElement("script");a.src="".concat(N).concat(s);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(a),a},F=function(e,s){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:s})},l=null,m=null,f=null,M=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},Q=function(e,s){return function(){window.Stripe?e(window.Stripe):s(new Error("Stripe.js not available"))}},J=function(e){return l!==null?l:(l=new Promise(function(s,a){if(typeof window>"u"||typeof document>"u"){s(null);return}if(window.Stripe&&e&&console.warn(g),window.Stripe){s(window.Stripe);return}try{var n=H();if(n&&e)console.warn(g);else if(!n)n=j(e);else if(n&&f!==null&&m!==null){var o;n.removeEventListener("load",f),n.removeEventListener("error",m),(o=n.parentNode)===null||o===void 0||o.removeChild(n),n=j(e)}f=Q(s,a),m=M(a),n.addEventListener("load",f),n.addEventListener("error",m)}catch(i){a(i);return}}),l.catch(function(s){return l=null,Promise.reject(s)}))},K=function(e,s,a){if(e===null)return null;var n=e.apply(void 0,s);return F(n,a),n},c,C=!1,E=function(){return c||(c=J(null).catch(function(e){return c=null,Promise.reject(e)}),c)};Promise.resolve().then(function(){return E()}).catch(function(t){C||console.warn(t)});var z=function(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];C=!0;var n=Date.now();return E().then(function(o){return K(o,s,n)})};const Y=({item:t})=>{const{price:e,discount:s,quantity:a,id:n,name:o,img:i}=t,{removeCartItem:d,changeItemQuantity:x}=V(),L=s?Math.round(e-e*s):e,[P,k]=u.useState(t.quantity),q=v=>{k(v),n&&x({id:n,value:v})};return r.jsxs("div",{className:"w-[290px] xxs:w-[350px] xsSm:w-auto xsSm:h-[240px] md:h-[180px] flex flex-col xsSm:flex-row gap-4 border border-divider rounded-xl",children:[r.jsx("div",{className:"cart-list-item__img flexitems-center justify-center h-full xsSm:min-w-[200px] border-r border-divider",children:r.jsx("img",{className:"object-cover h-full w-full aspect-square rounded-l-xl rounded-r-xl xsSm:rounded-r-none",src:i,alt:o})}),r.jsxs("div",{className:"cart-list-item__info flex flex-col w-full p-6 gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between -mt-2 xsSm:mt-0",children:[r.jsx("h1",{className:"text-[20px]",children:o}),r.jsx("button",{onClick:()=>d(t),className:"remove p-2 rounded-full duration-300 hover:bg-hoverLightGray",children:r.jsxs("div",{className:"relative h-6 w-6",children:[r.jsx("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 rotate-45 h-[2px] w-full bg-black"}),r.jsx("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 -rotate-45 w-full h-[2px] bg-black"})]})})]}),r.jsxs("div",{className:"flex -mt-2 flex-col-reverse md:flex-row justify-between xl:justify-normal gap-6",children:[r.jsx("div",{className:"w-full md:w-[230px]",children:r.jsx(R,{id:n,value:P,setValue:q})}),r.jsxs("div",{className:`flex ${s?"pr-[55px] xl:pr-0":""} items-center gap-4`,children:[r.jsxs("h2",{className:"font-bold text-[30px] lg:text-[40px] pt-1",children:["$",L*a]}),s&&r.jsxs("h4",{className:"relative text-[20px] text-gray line-through mt-4",children:["$",e*a,r.jsx("div",{className:"absolute font-semibold text-[14px] p-1 px-2 rounded-md bg-green text-white right-[-55px] top-[-10px]",children:`-${s*100}%`})]})]})]})]})]})},Z=({list:t})=>{const[e,s]=u.useState(!1),{items:a}=t,n=b();return u.useEffect(()=>{n.start({opacity:1,y:0})},[n]),r.jsxs(r.Fragment,{children:[r.jsx(y.ul,{initial:{opacity:0},transition:{delay:.1,duration:.2},animate:n,className:`cart-list duration-300 flex flex-col ${e?"h-auto":`h-[545px] xxs:h-[606px] ${a.length>3?"xsSm:h-[753px] md:h-[573px]":"xsSm:h-min"}`} overflow-hidden gap-4`,children:a.map(o=>r.jsx("li",{className:"cart-list-item flex justify-center items-center xsSm:block",children:r.jsx(Y,{item:o})},o.id))}),r.jsx("div",{className:`flex items-center justify-center mt-2 ${a.length>3?"xsSm:flex":a.length>1?"flex xsSm:hidden":"hidden"}`,children:r.jsx(p,{onClick:()=>s(o=>!o),isGreen:!0,text:`${e?"Show less":"Show more"}`})})]})},ee=()=>({store:S(e=>e.cart)}),te=()=>{var s;const t=S(a=>a.cart);return{total:(s=t==null?void 0:t.items)==null?void 0:s.reduce((a,n)=>{const o=n.discount?Math.round(n.price-n.price*n.discount):n.price;return a+o*n.quantity},0)}},re=()=>{const{store:t}=ee(),{quantity:e}=I(),{total:s}=te(),[a,n]=u.useState(!1),o=b();u.useEffect(()=>{o.start({opacity:1,y:0})},[o]);async function i(){n(!0);const d=await z("pk_test_51P7L3KDgyJmtJe68W3khXK9oCXDyUzXPP1dOb18twBORDwOgw2uTm9X1lGADHuRvwtt4o6HMHnGXcHfIdHUtTbL600xjCRAbJv");d&&await d.redirectToCheckout({lineItems:t.items.map(x=>({price:x.api_key,quantity:x.quantity})),mode:"payment",successUrl:"https://lis0vyi13.github.io/garden/#/success",cancelUrl:"https://lis0vyi13.github.io/garden/#/cancel"}),n(!1)}return r.jsxs("section",{className:"cart flex flex-col gap-10",children:[r.jsx($,{text:"Shopping cart",buttonText:"Back to the store"}),t.value>0?r.jsxs("div",{className:"cart-content flex flex-col xl:flex-row gap-8",children:[r.jsx("div",{className:"xl:w-[60%]",children:r.jsx(Z,{list:t})}),r.jsxs(y.div,{initial:{opacity:0,y:50},animate:o,className:"bg-lightGray h-full rounded-xl xl:w-[40%] p-7",children:[r.jsx("h3",{className:"font-bold text-4xl",children:"Order details"}),r.jsxs("div",{className:"pt-4 gap-6 flex flex-col xs:flex-row justify-between",children:[r.jsx("div",{className:"w-full xs:w-1/2",children:r.jsxs("h4",{className:"text-gray text-2xl sm:text-4xl leading-[3rem]",children:[e," items total"]})}),r.jsx("div",{className:"flex self-end items-end",children:r.jsxs("h2",{className:"font-bold text-[37px] lg:text-[46px] break-all",children:["$",s]})})]}),r.jsx("div",{className:"cart-button h-full flex mt-6",children:r.jsx(p,{disabled:a,onClick:i,text:"Order",extraClassName:`w-full self-end ${a?"bg-gray cursor-not-allowed":"bg-green hover:bg-hoverGreen"}`,isGreen:!0})})]})]}):r.jsxs("div",{className:"-mt-2",children:[r.jsx("p",{children:"Looks like you have no items in your basket currently."}),r.jsx(O,{to:"/all-products?from=&to=&discount=&sortBy=default&category=All+products",children:r.jsx(p,{extraClassName:"mt-5 w-full xs:w-auto",isGreen:!0,text:"Continue Shopping"})})]})]})},ce=()=>r.jsx(_,{block:"shopping-cart",children:r.jsx(re,{})});export{ce as default};
