import{r as p,u as k,a as P,j as e,s as C,c as S,p as g,b as B,T as F,e as _}from"./index-5kKwVPBw.js";import{P as A}from"./PageWrapper-BCY5xxNC.js";import{u as O,P as L}from"./ProductsList-DfPnFErH.js";import{B as w}from"./Button-ClSH_scI.js";import"./useCartActions-da3_bXKG.js";const T=({setOptions:c,setIsUpdating:s})=>{const{register:i,getValues:l,setValue:r}=O(),[m,n]=p.useState(!1),[o,d]=p.useState("By default"),[x,t]=p.useState("All products"),u=k(),y=P();p.useEffect(()=>{const a=new URLSearchParams(y.search);a.get("discount")==="true"?n(!0):n(!1),r("from",a.get("from")),r("to",a.get("to")),r("discount",a.get("discount")||!1),r("sortBy",a.get("sortBy")),d(a.get("sortBy")),t(a.get("category")),r("category",a.get("category")),v()},[y.search,r]);const v=()=>{s(!0);try{const a=l(),f=new URLSearchParams;f.set("from",a.from||""),f.set("to",a.to||""),f.set("discount",a.discount||""),f.set("sortBy",a.sortBy||""),f.set("category",a.category||""),u({pathname:y.pathname,search:f.toString()});const j=Object.keys(a).filter(h=>a[h]!=!1||h==="discount").reduce((h,b)=>(h[b]=a[b],h),{});j.from=+j.from||0,j.to=+j.to||500,c(h=>({...h,...j}))}catch(a){console.error(a)}finally{setTimeout(()=>{s(!1)},100)}};return{register:i,isChecked:m,selectValue:o,categoryValue:x,setIsChecked:n,onChange:v}},V=({register:c,onChange:s})=>e.jsxs("div",{className:"all-products__sort-price flex gap-4 items-center",children:[e.jsx("h5",{className:"font-semibold text-[20px]",children:"Price"}),e.jsx("input",{className:"border-divider duration-300 border-2 rounded-md p-2 w-[86px] xs:w-[110px]",placeholder:"from",type:"number",...c("from",{onChange:s})}),e.jsx("input",{className:"border-divider duration-300 border-2 rounded-md p-2 w-[86px] xs:w-[110px]",placeholder:"to",type:"number",...c("to",{onChange:s})})]}),R=({register:c,isChecked:s,toggleCheckbox:i})=>e.jsx("div",{className:"all-products__sort-discount flex w-fit items-center",children:e.jsxs("label",{htmlFor:"discount",className:"flex gap-4 items-center cursor-pointer",tabIndex:0,children:[e.jsx("h5",{className:"font-semibold text-[20px] select-none",children:"Discounted items"}),e.jsx("input",{id:"discount",className:"hidden",type:"checkbox",checked:s,...c("discount",{onChange:i})}),e.jsx("div",{className:"w-8 h-8 border-2 border-divider rounded-md flex items-center justify-center mr-2 transition-all duration-300",children:s&&e.jsx("svg",{className:"min-w-8 h-8 pointer-events-none bg-green rounded-md",viewBox:"0 0 24 24",fill:"none",stroke:"white",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]})}),D=({register:c,sortOptions:s,onChange:i,activeSelectValue:l})=>e.jsxs("div",{className:"all-products__sort-discount items-center flex gap-4",children:[e.jsx("h5",{className:"font-semibold text-[20px]",children:"Sorted"}),e.jsx("select",{className:"border-2 cursor-pointer border-divider p-2 rounded-md w-[175px] xs:w-[200px]",...c("sortBy",{onChange:i}),value:l||"",children:s.map(r=>e.jsx("option",{className:"text-[18px]",value:r.value,children:r.label},r.value))})]}),z=({register:c,onChange:s,categoryValue:i,categoriesOptions:l})=>e.jsxs("div",{className:"all-products__sort-category-filter items-center flex gap-4",children:[e.jsx("h5",{className:"font-semibold text-[20px]",children:"Category"}),e.jsxs("select",{className:"border-2 cursor-pointer border-divider p-2 rounded-md w-[150px] xs:w-[200px]",...c("category",{onChange:s}),value:i||"",children:[e.jsx("option",{className:"text-[18px]",value:"All products",children:"All products"}),l.map(r=>e.jsx("option",{className:"text-[18px]",value:r.value,children:r.name},r.value))]})]}),I=c=>{let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>{c(...i)},500)}},M=({setOptions:c,setIsUpdating:s,className:i})=>{const{register:l,onChange:r,isChecked:m,selectValue:n,categoryValue:o,setIsChecked:d}=T({setOptions:c,setIsUpdating:s}),x=()=>{d(!m),r()};return e.jsxs("section",{className:`all-products__sort inline-grid w-[260px] xs:w-auto grid-cols-1 md:grid-cols-2 lg:grid-cols-[repeat(3,_minmax(0,max-content))] items-center gap-8 ${i}`,children:[e.jsx(V,{register:l,onChange:I(r)}),e.jsx(R,{register:l,isChecked:m,toggleCheckbox:x}),e.jsx(D,{register:l,sortOptions:C,onChange:r,activeSelectValue:n}),e.jsx(z,{register:l,categoriesOptions:S,onChange:r,categoryValue:o})]})},N=p.memo(M),E=(c,s)=>p.useMemo(()=>{const{from:i,to:l,discount:r,sortBy:m,category:n}=c;let o=[...g];switch(o=o.filter(t=>{const u=t.discount?Math.round(t.price-t.price*t.discount):t.price;return u>=+i&&u<=+l&&(!r||t.discount)}),m){case"low-high":o.sort((t,u)=>t.price-(t.discount?t.price*t.discount:0)-(u.price-(u.discount?u.price*u.discount:0)));break;case"high-low":o.sort((t,u)=>u.price-(u.discount?u.price*u.discount:0)-(t.price-(t.discount?t.price*t.discount:0)));break}let d="";switch(n){case"Fertilizer":d=n,o=o.filter(t=>t.type==="fertilizer");break;case"Tools and equipment":d=n,o=o.filter(t=>t.type==="tools-and-equipment");break;case"Protective products and septic tanks":d=n,o=o.filter(t=>t.type==="protective-products-and-septic-tanks");break;case"Planting material":d=n,o=o.filter(t=>t.type==="planting-material");break;case"Pots and planters":d=n,o=o.filter(t=>t.type==="pots-and-planters");break;case"Decor":d=n,o=o.filter(t=>t.type==="decor");break;default:d="All products";break}return s(r?"Discounted items":d),{sortedProducts:o}},[c]),U=()=>{let c=0;for(let s=0;s<g.length;s++){const i=g[s].discount?Math.round(g[s].price*g[s].discount):g[s].price;c<i&&(c=i)}return c},q=()=>{const[c,s]=p.useState("All products"),[i,l]=p.useState(!1),[r,m]=p.useState(!1),[n,o]=p.useState({from:0,to:U(),discount:!1,sortBy:"default",category:"All products"}),{sortedProducts:d}=E(n,s),x=p.useRef(null);return B(x,()=>l(!1)),e.jsxs("div",{className:"relative all-products h-full",children:[e.jsxs("div",{className:"fixed top-[103px] left-0 px-5 py-4 md:relative md:top-0 md:px-0 md:py-0 bg-white z-40 w-full flex items-center justify-between",children:[e.jsx(F,{text:c}),e.jsx(w,{onClick:()=>l(!0),text:"Filters",extraClassName:"px-6 py-[10px] md:hidden",isGreen:!0})]}),e.jsx("div",{ref:x,className:"relative flex items-center justify-between",children:e.jsxs("div",{className:`${i?"translate-x-[1%]":"translate-x-[120%]"} flex flex-col duration-300 right-0 top-[110px] rounded-xl p-4 fixed border-2 bg-white z-40 md:hidden`,children:[e.jsx(N,{setIsUpdating:m,setOptions:o}),e.jsx(w,{onClick:()=>l(!1),text:"Close",extraClassName:"text-white py-[12px] bg-red hover:bg-hoverRed mt-4"})]})}),e.jsx("div",{className:"mt-16 md:mt-10 mb-2",children:e.jsx(N,{className:"hidden md:inline-grid",setIsUpdating:m,setOptions:o})}),r?e.jsx(_,{}):e.jsx(L,{list:d})]})},K=()=>e.jsx(A,{block:"all-products",children:e.jsx(q,{})});export{K as default};
