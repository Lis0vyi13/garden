import{i as A,k as j,l as T,n as G,r as u,j as t,m,o as w,q as I,L as $}from"./index-CURUI6u3.js";import{T as V,H as R,F as _}from"./Footer-XMu_VlCS.js";import{C as F}from"./Counter-B1ENEB-x.js";import{u as H}from"./useCartActions-wu9ca1bx.js";import{B as p}from"./Button-BNBhvA9E.js";import{P as O}from"./PageWrapper-C8DTMT6f.js";import"./useActions-POwXs3Je.js";function X(r){r.values.forEach(e=>e.stop())}function f(r,e){[...e].reverse().forEach(a=>{const s=r.getVariant(a);s&&j(r,s),r.variantChildren&&r.variantChildren.forEach(i=>{f(i,e)})})}function B(r,e){if(Array.isArray(e))return f(r,e);if(typeof e=="string")return f(r,[e]);j(r,e)}function U(){const r=new Set,e={subscribe(n){return r.add(n),()=>void r.delete(n)},start(n,a){const s=[];return r.forEach(i=>{s.push(A(i,n,{transitionOverride:a}))}),Promise.all(s)},set(n){return r.forEach(a=>{B(a,n)})},stop(){r.forEach(n=>{X(n)})},mount(){return()=>{e.stop()}}};return e}function W(){const r=T(U);return G(r.mount,[]),r}const y=W,D=({item:r})=>{const{price:e,discount:n,quantity:a,id:s,name:i,img:o}=r,{removeCartItem:C,changeItemQuantity:E}=H(),L=n?Math.round(e-e*n):e,[P,k]=u.useState(r.quantity),q=h=>{k(h),s&&E({id:s,value:h})};return t.jsxs("div",{className:"w-[290px] xxs:w-[350px] xsSm:w-auto xsSm:h-[240px] md:h-[180px] flex flex-col xsSm:flex-row gap-4 border border-divider rounded-xl",children:[t.jsx("div",{className:"cart-list-item__img flexitems-center justify-center h-full xsSm:min-w-[200px] border-r border-divider",children:t.jsx("img",{className:"object-cover h-full w-full aspect-square rounded-l-xl rounded-r-xl xsSm:rounded-r-none",src:o,alt:i})}),t.jsxs("div",{className:"cart-list-item__info flex flex-col w-full p-6 gap-6",children:[t.jsxs("div",{className:"flex items-center justify-between -mt-2 xsSm:mt-0",children:[t.jsx("h1",{className:"text-[20px]",children:i}),t.jsx("button",{onClick:()=>C(r),className:"remove p-2 rounded-full duration-300 hover:bg-hoverLightGray",children:t.jsxs("div",{className:"relative h-6 w-6",children:[t.jsx("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 rotate-45 h-[2px] w-full bg-black"}),t.jsx("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 -rotate-45 w-full h-[2px] bg-black"})]})})]}),t.jsxs("div",{className:"flex -mt-2 flex-col-reverse md:flex-row justify-between xl:justify-normal gap-6",children:[t.jsx("div",{className:"w-full md:w-[230px]",children:t.jsx(F,{id:s,value:P,setValue:q})}),t.jsxs("div",{className:`flex ${n?"pr-[55px] xl:pr-0":""} items-center gap-4`,children:[t.jsxs("h2",{className:"font-bold text-[30px] lg:text-[40px] pt-1",children:["$",L*a]}),n&&t.jsxs("h4",{className:"relative text-[20px] text-gray line-through mt-4",children:["$",e*a,t.jsx("div",{className:"absolute font-semibold text-[14px] p-1 px-2 rounded-md bg-green text-white right-[-55px] top-[-10px]",children:`-${n*100}%`})]})]})]})]})]})},M=({list:r})=>{const[e,n]=u.useState(!1),{items:a}=r,s=y();return u.useEffect(()=>{s.start({opacity:1,y:0})},[s]),t.jsxs(t.Fragment,{children:[t.jsx(m.ul,{initial:{opacity:0},transition:{delay:.1,duration:.2},animate:s,className:`cart-list duration-300 flex flex-col ${e?"h-auto":`h-[545px] xxs:h-[606px] ${a.length>3?"xsSm:h-[753px] md:h-[573px]":"xsSm:h-min"}`} overflow-hidden gap-4`,children:a.map(i=>t.jsx("li",{className:"cart-list-item flex justify-center items-center xsSm:block",children:t.jsx(D,{item:i})},i.id))}),t.jsx("div",{className:`flex items-center justify-center mt-2 ${a.length>3?"xsSm:flex":a.length>1?"flex xsSm:hidden":"hidden"}`,children:t.jsx(p,{onClick:()=>n(i=>!i),isGreen:!0,text:`${e?"Show less":"Show more"}`})})]})},Q=()=>({store:w(e=>e.cart)}),J=()=>{var n;const r=w(a=>a.cart);return{total:(n=r==null?void 0:r.items)==null?void 0:n.reduce((a,s)=>{const i=s.discount?Math.round(s.price-s.price*s.discount):s.price;return a+i*s.quantity},0)}};var S="https://js.stripe.com/v3",K=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,v="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",z=function(){for(var e=document.querySelectorAll('script[src^="'.concat(S,'"]')),n=0;n<e.length;n++){var a=e[n];if(K.test(a.src))return a}return null},g=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",a=document.createElement("script");a.src="".concat(S).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(a),a},Y=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"3.3.0",startTime:n})},l=null,d=null,x=null,Z=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},ee=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},te=function(e){return l!==null?l:(l=new Promise(function(n,a){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(v),window.Stripe){n(window.Stripe);return}try{var s=z();if(s&&e)console.warn(v);else if(!s)s=g(e);else if(s&&x!==null&&d!==null){var i;s.removeEventListener("load",x),s.removeEventListener("error",d),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=g(e)}x=ee(n,a),d=Z(a),s.addEventListener("load",x),s.addEventListener("error",d)}catch(o){a(o);return}}),l.catch(function(n){return l=null,Promise.reject(n)}))},re=function(e,n,a){if(e===null)return null;var s=e.apply(void 0,n);return Y(s,a),s},c,b=!1,N=function(){return c||(c=te(null).catch(function(e){return c=null,Promise.reject(e)}),c)};Promise.resolve().then(function(){return N()}).catch(function(r){b||console.warn(r)});var ne=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];b=!0;var s=Date.now();return N().then(function(i){return re(i,n,s)})};const se=async(r,e)=>{e(!0);const n=await ne("pk_test_51P7L3KDgyJmtJe68W3khXK9oCXDyUzXPP1dOb18twBORDwOgw2uTm9X1lGADHuRvwtt4o6HMHnGXcHfIdHUtTbL600xjCRAbJv");n&&await n.redirectToCheckout({lineItems:r.items.map(a=>({price:a.api_key,quantity:a.quantity})),mode:"payment",successUrl:"https://lis0vyi13.github.io/garden/#/success",cancelUrl:"https://lis0vyi13.github.io/garden/#/cancel"}),e(!1)},ae=()=>{const{store:r}=Q(),{quantity:e}=I(),{total:n}=J(),[a,s]=u.useState(!1),i=y();u.useEffect(()=>{i.start({opacity:1,y:0})},[i]);const o=async()=>{await se(r,s)};return t.jsxs("section",{className:"cart flex flex-col gap-10",children:[t.jsx(V,{text:"Shopping cart",buttonText:"Back to the store"}),r.value>0?t.jsxs("div",{className:"cart-content flex flex-col xl:flex-row gap-8",children:[t.jsx("div",{className:"xl:w-[60%]",children:t.jsx(M,{list:r})}),t.jsxs(m.div,{initial:{opacity:0,y:50},animate:i,className:"bg-lightGray h-full rounded-xl xl:w-[40%] p-7",children:[t.jsx("h3",{className:"font-bold text-4xl",children:"Order details"}),t.jsxs("div",{className:"pt-4 gap-6 flex flex-col xs:flex-row justify-between",children:[t.jsx("div",{className:"w-full xs:w-1/2",children:t.jsxs("h4",{className:"text-gray text-2xl sm:text-4xl leading-[3rem]",children:[e," items total"]})}),t.jsx("div",{className:"flex self-end items-end",children:t.jsxs("h2",{className:"font-bold text-[37px] lg:text-[46px] break-all",children:["$",n]})})]}),t.jsx("div",{className:"cart-button h-full flex mt-6",children:t.jsx(p,{disabled:a,onClick:o,text:"Order",extraClassName:`w-full self-end ${a?"bg-gray cursor-not-allowed":"bg-green hover:bg-hoverGreen"}`,isGreen:!0})})]})]}):t.jsxs(m.div,{initial:{y:20,opacity:0},whileInView:{y:0,opacity:1},viewport:{once:!0,amount:.25},transition:{duration:.3},className:"-mt-2",children:[t.jsx("p",{children:"Looks like you have no items in your basket currently."}),t.jsx($,{to:"/all-products?from=&to=&discount=&sortBy=default&category=All+products",children:t.jsx(p,{extraClassName:"mt-5 w-full xs:w-auto",isGreen:!0,text:"Continue Shopping"})})]})]})},me=()=>t.jsxs(t.Fragment,{children:[t.jsxs(R,{children:[t.jsx("title",{children:"Shopping cart"}),t.jsx("meta",{name:"description",content:"Shopping cart"})]}),t.jsx("main",{className:"main",children:t.jsx(O,{block:"shopping-cart",children:t.jsx(ae,{})})}),t.jsx(_,{})]});export{me as default};
