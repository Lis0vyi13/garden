import{r as p,u as P,b as C,j as e,s as S,c as B,p as g,e as F,m as v,T as V,f as _}from"./index-m3K3TnFm.js";import{P as A}from"./PageWrapper-BAnWqsv0.js";import{u as O,P as L}from"./ProductsList-BbVoSUov.js";import{B as N}from"./Button-CVMUNf6n.js";import"./useCartActions-BdXx9qSE.js";import"./useActions-DayzOZMt.js";const T=({setOptions:i,setIsUpdating:s})=>{const{register:a,getValues:n,setValue:r}=O(),[m,l]=p.useState(!1),[o,d]=p.useState("By default"),[x,t]=p.useState("All products"),u=P(),j=C();p.useEffect(()=>{const c=new URLSearchParams(j.search);c.get("discount")==="true"?l(!0):l(!1),r("from",c.get("from")),r("to",c.get("to")),r("discount",c.get("discount")||!1),r("sortBy",c.get("sortBy")),d(c.get("sortBy")),t(c.get("category")),r("category",c.get("category")),b()},[j.search,r]);const b=()=>{s(!0);try{const c=n(),f=new URLSearchParams;f.set("from",c.from||""),f.set("to",c.to||""),f.set("discount",c.discount||""),f.set("sortBy",c.sortBy||""),f.set("category",c.category||""),u({pathname:j.pathname,search:f.toString()});const y=Object.keys(c).filter(h=>c[h]!=!1||h==="discount").reduce((h,w)=>(h[w]=c[w],h),{});y.from=+y.from||0,y.to=+y.to||500,i(h=>({...h,...y}))}catch(c){console.error(c)}finally{setTimeout(()=>{s(!1)},100)}};return{register:a,isChecked:m,selectValue:o,categoryValue:x,setIsChecked:l,onChange:b}},I=({register:i,onChange:s})=>e.jsxs("div",{className:"all-products__sort-price flex gap-4 items-center",children:[e.jsx("h5",{className:"font-semibold text-[20px]",children:"Price"}),e.jsx("input",{className:"border-divider duration-300 border-2 rounded-md p-2 w-[86px] xs:w-[110px]",placeholder:"from",type:"number",...i("from",{onChange:s})}),e.jsx("input",{className:"border-divider duration-300 border-2 rounded-md p-2 w-[86px] xs:w-[110px]",placeholder:"to",type:"number",...i("to",{onChange:s})})]}),R=({register:i,isChecked:s,toggleCheckbox:a})=>e.jsx("div",{className:"all-products__sort-discount flex w-fit items-center",children:e.jsxs("label",{htmlFor:"discount",className:"flex gap-4 items-center cursor-pointer",tabIndex:0,children:[e.jsx("h5",{className:"font-semibold text-[20px] select-none",children:"Discounted items"}),e.jsx("input",{id:"discount",className:"hidden",type:"checkbox",checked:s,...i("discount",{onChange:a})}),e.jsx("div",{className:"w-8 h-8 border-2 border-divider rounded-md flex items-center justify-center mr-2 transition-all duration-300",children:s&&e.jsx("svg",{className:"min-w-8 h-8 pointer-events-none bg-green rounded-md",viewBox:"0 0 24 24",fill:"none",stroke:"white",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]})}),D=({register:i,sortOptions:s,onChange:a,activeSelectValue:n})=>e.jsxs("div",{className:"all-products__sort-discount items-center flex gap-4",children:[e.jsx("h5",{className:"font-semibold text-[20px]",children:"Sorted"}),e.jsx("select",{className:"border-2 cursor-pointer border-divider p-2 rounded-md w-[175px] xs:w-[200px]",...i("sortBy",{onChange:a}),value:n||"",children:s.map(r=>e.jsx("option",{className:"text-[18px]",value:r.value,children:r.label},r.value))})]}),z=({register:i,onChange:s,categoryValue:a,categoriesOptions:n})=>e.jsxs("div",{className:"all-products__sort-category-filter items-center flex gap-4",children:[e.jsx("h5",{className:"font-semibold text-[20px]",children:"Category"}),e.jsxs("select",{className:"border-2 cursor-pointer border-divider p-2 rounded-md w-[150px] xs:w-[200px]",...i("category",{onChange:s}),value:a||"",children:[e.jsx("option",{className:"text-[18px]",value:"All products",children:"All products"}),n.map(r=>e.jsx("option",{className:"text-[18px]",value:r.value,children:r.name},r.value))]})]}),M=i=>{let s;return(...a)=>{clearTimeout(s),s=setTimeout(()=>{i(...a)},500)}},E=({setOptions:i,setIsUpdating:s,className:a})=>{const{register:n,onChange:r,isChecked:m,selectValue:l,categoryValue:o,setIsChecked:d}=T({setOptions:i,setIsUpdating:s}),x=()=>{d(!m),r()};return e.jsxs("section",{className:`all-products__sort inline-grid w-[260px] xs:w-auto grid-cols-1 md:grid-cols-2 lg:grid-cols-[repeat(3,_minmax(0,max-content))] items-center gap-8 ${a}`,children:[e.jsx(I,{register:n,onChange:M(r)}),e.jsx(R,{register:n,isChecked:m,toggleCheckbox:x}),e.jsx(D,{register:n,sortOptions:S,onChange:r,activeSelectValue:l}),e.jsx(z,{register:n,categoriesOptions:B,onChange:r,categoryValue:o})]})},k=p.memo(E),U=(i,s)=>p.useMemo(()=>{const{from:a,to:n,discount:r,sortBy:m,category:l}=i;let o=[...g];switch(o=o.filter(t=>{const u=t.discount?Math.round(t.price-t.price*t.discount):t.price;return u>=+a&&u<=+n&&(!r||t.discount)}),m){case"low-high":o.sort((t,u)=>t.price-(t.discount?t.price*t.discount:0)-(u.price-(u.discount?u.price*u.discount:0)));break;case"high-low":o.sort((t,u)=>u.price-(u.discount?u.price*u.discount:0)-(t.price-(t.discount?t.price*t.discount:0)));break}let d="";switch(l){case"Fertilizer":d=l,o=o.filter(t=>t.type==="fertilizer");break;case"Tools and equipment":d=l,o=o.filter(t=>t.type==="tools-and-equipment");break;case"Protective products and septic tanks":d=l,o=o.filter(t=>t.type==="protective-products-and-septic-tanks");break;case"Planting material":d=l,o=o.filter(t=>t.type==="planting-material");break;case"Pots and planters":d=l,o=o.filter(t=>t.type==="pots-and-planters");break;case"Decor":d=l,o=o.filter(t=>t.type==="decor");break;default:d="All products";break}return s(r?"Discounted items":d),{sortedProducts:o}},[i]),q=()=>{let i=0;for(let s=0;s<g.length;s++){const a=g[s].discount?Math.round(g[s].price*g[s].discount):g[s].price;i<a&&(i=a)}return i},H=()=>{const[i,s]=p.useState("All products"),[a,n]=p.useState(!1),[r,m]=p.useState(!1),[l,o]=p.useState({from:0,to:q(),discount:!1,sortBy:"default",category:"All products"}),{sortedProducts:d}=U(l,s),x=p.useRef(null);return F(x,()=>n(!1)),e.jsxs("div",{className:"relative all-products h-full",children:[e.jsxs(v.div,{className:"fixed top-[103px] left-0 px-5 py-4 md:relative md:top-0 md:px-0 md:py-0 bg-white z-40 w-full flex items-center justify-between",initial:{y:-50,opacity:0},whileInView:{y:0,opacity:1},transition:{duration:.5},viewport:{once:!0},children:[e.jsx(V,{text:i}),e.jsx(N,{onClick:()=>n(!0),text:"Filters",extraClassName:"px-6 py-[10px] md:hidden",isGreen:!0})]}),e.jsx("div",{ref:x,className:"relative flex items-center justify-between",children:e.jsxs(v.div,{className:`${a?"translate-x-0":"translate-x-full"} flex flex-col duration-300 right-0 top-[110px] rounded-xl p-4 fixed border-2 bg-white z-40 md:hidden`,initial:{x:"100%"},whileInView:{x:a?"0%":"100%"},transition:{duration:.3},viewport:{once:!0},children:[e.jsx(k,{setIsUpdating:m,setOptions:o}),e.jsx(N,{onClick:()=>n(!1),text:"Close",extraClassName:"text-white py-[12px] bg-red hover:bg-hoverRed mt-4"})]})}),e.jsx("div",{className:"mt-16 md:mt-10 mb-2",children:e.jsx(k,{className:"hidden md:inline-grid",setIsUpdating:m,setOptions:o})}),e.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"mt-16 md:mt-10 mb-2",viewport:{once:!0},children:r?e.jsx(_,{}):e.jsx(L,{list:d})})]})},X=()=>e.jsx(A,{block:"all-products",children:e.jsx(H,{})});export{X as default};
